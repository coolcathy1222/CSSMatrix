<!DOCTYPE html>
<html>
<head>
	<style type="text/css">

	body {	background-color: #222; }

	div#container {
		webkit-perspective: 500px;
		webkit-perspective-origin: 50% 50%;
		webkit-transform-style: preserve-3d;
		padding: 25px;
		font-family: Courier;
		text-align: center;
	}

	div.cssmatrix {
		position: relative;
		height: 200px;
		width: 300px;
		background-color: #666;
	}
	
	label {
		color: #aaa;
		position: relative;
		height: 1em;
		width: 10em;
	}

	ul#ctrl {
		list-style: none;
	}

	ul#ctrl li {
		display: inline-block;
		height: 2em;
		width: 10em;
		padding-top: 0.5em;
	}

	ul#ctrl li label {
		float: right;
	}

	</style>
	<script type="text/javascript" src="//code.jquery.com/jquery-1.10.2.min.js"></script>
 	<script type="text/javascript" src="cssmatrix.js"></script>
	<script type="text/javascript">

	var inputs = [ 'rotateX', 'rotateY', 'rotateZ', 'translateX', 'translateY', 'translateZ', 'skewX', 'skewY', 'scaleX', 'scaleY', 'scaleZ' ];

	var Ctrlr = function(){
		this.webkit = $('#webkit');
		this.custom = $('#custom');
	};

	Ctrlr.prototype = {

		rotateX : function(x){
			var m1 = new WebKitCSSMatrix(), m2 = new CSSMatrix();
			this.update(m1.rotate(9*x,0,0).toString(), m2.rotate(9*x,0,0).toString());
		},

		rotateY : function(y){
			var m1 = new WebKitCSSMatrix(), m2 = new CSSMatrix();
			this.update(m1.rotate(0,9*y,0).toString(), m2.rotate(0,9*y,0).toString());
		}, 

		rotateZ : function(z){
			var m1 = new WebKitCSSMatrix(), m2 = new CSSMatrix();
			this.update(m1.rotate(0,0,9*z).toString(), m2.rotate(0,0,9*z).toString());
		},

		translateX : function(x){ 
			var m1 = new WebKitCSSMatrix(), m2 = new CSSMatrix();
			this.update(m1.translate(x,0,0).toString(), m2.translate(x,0,0).toString());
		},

		translateY : function(y){
			var m1 = new WebKitCSSMatrix(), m2 = new CSSMatrix();
			this.update(m1.translate(0,y,0).toString(), m2.translate(0,y,0).toString());
		},

		translateZ : function(z){
			var m1 = new WebKitCSSMatrix(), m2 = new CSSMatrix();
			this.update(m1.translate(0,0,z).toString(), m2.translate(0,0,z).toString())
		},

		skewX : function(x){
			var m1 = new WebKitCSSMatrix(), m2 = new CSSMatrix();
			this.update(m1.skewX(x).toString(), m2.skewX(x).toString())
		},

		skewY : function(y){
			var m1 = new WebKitCSSMatrix(), m2 = new CSSMatrix();
			this.update(m1.skewY(y).toString(), m2.skewY(y).toString())
		},

		scaleX : function(x){
			var m1 = new WebKitCSSMatrix(), m2 = new CSSMatrix();
			this.update(m1.scale(x,1,1).toString(), m2.scale(x,1,1).toString())
		},

		scaleY : function(y){
			var m1 = new WebKitCSSMatrix(), m2 = new CSSMatrix();
			this.update(m1.scale(1,y,1).toString(), m2.scale(1,y,1).toString())
		},

		scaleZ : function(z){
			var m1 = new WebKitCSSMatrix(), m2 = new CSSMatrix();
			this.update(m1.scale(1,1,z).toString(), m2.scale(1,1,z).toString())
		},

		update : function(str1,str2){
			webkit.style.webkitTransform = str1;
			custom.style.webkitTransform = str2;
		}
	};

	window.onload = function(){

		var ctrlr = new Ctrlr();

		for(var i=0;i<inputs.length;i++){

			$('#ctrl').append(
				"<li><label for='" + inputs[i] + "'>" + inputs[i] + 
				"</label><input type='range' value='0' step='0.1' min='-10' max='10' name='" + 
				inputs[i] + "' id='" + inputs[i] + "' /></li>")

			$('#'+inputs[i]).change(function(i){
				ctrlr[this.id]($(this).val())
			})

		}
	}

	</script>
</head>
<body>

<div id="container">
	<div id="custom" class="cssmatrix">
		<h3>CSSMatrix Polyfill</h3>
		<table>
			<tbody>
				<tr><td>m11</td><td>m12</td><td>m13</td><td>m14</td></tr>
				<tr><td>m21</td><td>m22</td><td>m23</td><td>m24</td></tr>
				<tr><td>m31</td><td>m32</td><td>m33</td><td>m34</td></tr>
				<tr><td>m41</td><td>m42</td><td>m43</td><td>m44</td></tr>
			</tbody>
		</table>
	</div>
	<div id="webkit" class="cssmatrix">
		<h3>WebKitCSSMatrix</h3>
		<table>
			<tbody>
				<tr><td>m11</td><td>m12</td><td>m13</td><td>m14</td></tr>
				<tr><td>m21</td><td>m22</td><td>m23</td><td>m24</td></tr>
				<tr><td>m31</td><td>m32</td><td>m33</td><td>m34</td></tr>
				<tr><td>m41</td><td>m42</td><td>m43</td><td>m44</td></tr>
			</tbody>
		</table>
	</div>
</div>

<div id="controls">
	<ul id="ctrl">
	</ul>
</div>

	
</body>
</html>